# ๐ฑ ููุฎุต ุฅุตูุงุญ ุงูุฅุดุนุงุฑุงุช ูู ุงูุฅูุชุงุฌ

## ๐ฏ ุงููุดููุฉ
ุงูุฅุดุนุงุฑุงุช ุชุนูู ูู **Expo Go** ููู ูุง ุชุนูู ูู **Production Build** (APK).

---

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุชุญุฏูุซ `mobile/src/services/notificationService.ts`
**ุงูุชุบููุฑ**: ุงุณุชุฎุฏุงู `projectId` ุซุงุจุช ูุจุงุดุฑุฉ
```typescript
// ูุจู
let projectId = Constants.expoConfig?.extra?.eas?.projectId;
if (!projectId) {
  projectId = '1881cacc-0c4d-4a83-a05e-19f20a07f2c0';
}

// ุจุนุฏ
const projectId = '1881cacc-0c4d-4a83-a05e-19f20a07f2c0';
```

**ุงูุณุจุจ**: ูู Production Buildุ ูุฏ ูุง ูุชู ุชุญููู `Constants.expoConfig` ุจุดูู ุตุญูุญ.

---

### 2. ุชุญุฏูุซ `mobile/App.tsx`
**ุงูุชุบููุฑ**: ุทูุจ ุฃุฐููุงุช ุตุฑูุญ ูู Android 13+
```typescript
// ุฅุถุงูุฉ ุทูุจ ุงูุฃุฐููุงุช
if (Platform.OS === 'android' && Platform.Version >= 33) {
  const { status } = await Notifications.requestPermissionsAsync();
  if (status !== 'granted') {
    Alert.alert('ุชูุจูู', 'ูุฌุจ ุงูุณูุงุญ ุจุงูุฅุดุนุงุฑุงุช...');
    return;
  }
}
```

**ุงูุณุจุจ**: Android 13+ ูุชุทูุจ ุฅุฐู `POST_NOTIFICATIONS` ุจุดูู ุตุฑูุญ.

---

### 3. ุชุญุฏูุซ `mobile/app.json`
**ุงูุชุบููุฑุงุช**:
- ุฅุถุงูุฉ ุฃุฐููุงุช: `SCHEDULE_EXACT_ALARM`, `USE_EXACT_ALARM`
- ุชูุนูู: `useNextNotificationsApi: true`
- ุฑูุน: `versionCode` ูู 2 ุฅูู 3

**ุงูุณุจุจ**: ุชุญุณูู ุฏุนู ุงูุฅุดุนุงุฑุงุช ูู Android ุงูุญุฏูุซ.

---

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ

### 1. `mobile/PRODUCTION_NOTIFICATIONS_FIX.md`
ุฏููู ุดุงูู ูุดุฑุญ:
- ุงูุฃุณุจุงุจ ุงููุญุชููุฉ ูููุดููุฉ
- 6 ุญููู ููุตูุฉ
- ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ
- ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### 2. `mobile/TEST_NOTIFICATIONS.md`
ุฏููู ุงูุงุฎุชุจุงุฑ ูุดูู:
- ููููุฉ ุจูุงุก APK
- ุทุฑู ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช (3 ุทุฑู)
- ูุญุต Logs
- Checklist ูุงูู

### 3. `server/test-push-notification.js`
ุณูุฑูุจุช Node.js ูุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช:
```bash
node test-push-notification.js ExponentPushToken[xxx]
node test-push-notification.js ExponentPushToken[xxx] trade
```

### 4. `mobile/QUICK_FIX_AR.md`
ููุฎุต ุณุฑูุน ุจุงูุนุฑุจูุฉ ููุฎุทูุงุช ุงูุฃุณุงุณูุฉ.

### 5. `ุญู_ูุดููุฉ_ุงูุฅุดุนุงุฑุงุช_ูู_ุงูุฅูุชุงุฌ.md`
ุฏููู ุดุงูู ุจุงูุนุฑุจูุฉ.

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ููู ุฌุฏุงู!)

### 1๏ธโฃ ุชูุนูู Firebase Cloud Messaging (Legacy API)
**ูุฐู ุงูุฎุทูุฉ ุถุฑูุฑูุฉ!**

1. ุงูุชุญ: https://console.firebase.google.com/project/icti-34ac0/settings/cloudmessaging
2. ูู ูุณู **Cloud Messaging API (Legacy)** - ุงุถุบุท **Enable**
3. ุงูุชูู! โ

โ๏ธ **ุจุฏูู ูุฐู ุงูุฎุทูุฉุ ุงูุฅุดุนุงุฑุงุช ูู ุชุนูู ูู ุงูุฅูุชุงุฌ!**

๐ **ุฏููู ููุตู**: ุฑุงุฌุน ููู `ุชูุนูู_FCM_Legacy.md` ุฃู ุงูุชุญ `QUICK_FIX_FCM.html`

---

### 2๏ธโฃ ุจูุงุก APK ุฌุฏูุฏ
```bash
cd mobile
eas build --platform android --profile production
```

---

### 3๏ธโฃ ุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ุญูููู
1. ุซุจุช APK
2. ุณุฌู ุฏุฎูู
3. ุชุญูู ูู ุฑุณุงูุฉ: "Push token registered with server"

---

### 4๏ธโฃ ุงูุชุญูู ูู Token
ุงูุชุญ ูู ุงููุชุตูุญ:
```
https://ict-ai-trader-production.up.railway.app/api/auth/list-push-tokens
```

---

### 5๏ธโฃ ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑ
**ุงูุทุฑููุฉ 1**: Expo Push Tool
```
https://expo.dev/notifications
```

**ุงูุทุฑููุฉ 2**: ุงูุณูุฑูุจุช
```bash
cd server
node test-push-notification.js ExponentPushToken[YOUR_TOKEN]
```

---

## ๐ ุงูุฃุณุจุงุจ ุงูุฑุฆูุณูุฉ ูููุดููุฉ

### ุงูุณุจุจ #1: Firebase Cloud Messaging ุบูุฑ ููุนู
**ุงูุญู**: ุชูุนูู FCM ูู Firebase Console (ุงูุฎุทูุฉ 1 ุฃุนูุงู)

### ุงูุณุจุจ #2: Project ID ุบูุฑ ุตุญูุญ
**ุงูุญู**: โ ุชู ุฅุตูุงุญู ูู ุงูููุฏ

### ุงูุณุจุจ #3: ุฃุฐููุงุช Android 13+
**ุงูุญู**: โ ุชู ุฅุตูุงุญู ูู ุงูููุฏ

### ุงูุณุจุจ #4: Battery Optimization
**ุงูุญู**: ุงููุณุชุฎุฏู ูุญุชุงุฌ ุชุนุทููู ูุฏููุงู (ุฎุงุตุฉ Xiaomi/Huawei)

---

## ๐ Checklist

- [x] ุชุญุฏูุซ `notificationService.ts`
- [x] ุชุญุฏูุซ `App.tsx`
- [x] ุชุญุฏูุซ `app.json`
- [x] ุฅูุดุงุก ูููุงุช ุงูุชูุซูู
- [x] ุฅูุดุงุก ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ
- [ ] **ุชูุนูู FCM ูู Firebase Console** โ๏ธ
- [ ] ุจูุงุก APK ุฌุฏูุฏ
- [ ] ุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ุญูููู
- [ ] ุงูุชุญูู ูู ูุตูู ุงูุฅุดุนุงุฑุงุช

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุฌููุน ุงูุฎุทูุงุช:
- โ ุงูุฅุดุนุงุฑุงุช ุชุนูู ูู Expo Go
- โ ุงูุฅุดุนุงุฑุงุช ุชุนูู ูู Production Build
- โ ุชุธูุฑ ุนูุฏ ุฅุบูุงู ุงูุชุทุจูู
- โ ุชุธูุฑ ุนูุฏ ููู ุงูุดุงุดุฉ
- โ ุชุตุฏุฑ ุตูุช
- โ ุงูููุฑ ููุชุญ ุงูุชุทุจูู

---

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:
1. ุฑุงุฌุน `mobile/PRODUCTION_NOTIFICATIONS_FIX.md`
2. ุชุญูู ูู Firebase Console Logs
3. ุชุญูู ูู Railway Logs
4. ุงุณุชุฎุฏู `adb logcat` ููุญุต Android Logs

---

## ๐ ุงููููุงุช ุงููุฑุฌุนูุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `mobile/PRODUCTION_NOTIFICATIONS_FIX.md` | ุฏููู ุดุงูู ุจุงูุฅูุฌููุฒูุฉ |
| `mobile/TEST_NOTIFICATIONS.md` | ุฏููู ุงูุงุฎุชุจุงุฑ |
| `mobile/QUICK_FIX_AR.md` | ููุฎุต ุณุฑูุน ุจุงูุนุฑุจูุฉ |
| `ุญู_ูุดููุฉ_ุงูุฅุดุนุงุฑุงุช_ูู_ุงูุฅูุชุงุฌ.md` | ุฏููู ุดุงูู ุจุงูุนุฑุจูุฉ |
| `server/test-push-notification.js` | ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ |

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ุฌููุน ุงูุฅุตูุงุญุงุช ุงููุงุฒูุฉ ูู ุงูููุฏ. ุงูุฎุทูุฉ ุงูุฃูู ุงูุขู ูู:

**๐ฅ ุชูุนูู Firebase Cloud Messaging ูู Firebase Console**

ุจุฏูู ูุฐู ุงูุฎุทูุฉุ ุงูุฅุดุนุงุฑุงุช ูู ุชุนูู ูู Production Build ุญุชู ูู ูุงู ุงูููุฏ ุตุญูุญ 100%.

ุจุนุฏ ุชูุนูู FCMุ ูู ุจุจูุงุก APK ุฌุฏูุฏ ูุงุฎุชุจุฑ ุนูู ุฌูุงุฒ ุญูููู.
